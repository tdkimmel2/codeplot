DataSetInfo              : [dataset] : Added class "Signal"
                         : Add Tree pi0tree of type Signal with 2054980 events
DataSetInfo              : [dataset] : Added class "Background"
                         : Add Tree pi0tree of type Background with 4933019 events
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 32)                448       
_________________________________________________________________
dropout_1 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 32)                1056      
_________________________________________________________________
dropout_2 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 66        
=================================================================
Total params: 1,570
Trainable params: 1,570
Non-trainable params: 0
_________________________________________________________________
Factory                  : Booking method: [1mPyKeras[0m
                         : 
PyKeras                  : [dataset] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'pi0p3' <---> Output : variable 'pi0p3'
                         : Input : variable 'pi0p3cms' <---> Output : variable 'pi0p3cms'
                         : Input : variable 'gm1e' <---> Output : variable 'gm1e'
                         : Input : variable 'gm2e' <---> Output : variable 'gm2e'
                         : Input : variable 'gm1e925' <---> Output : variable 'gm1e925'
                         : Input : variable 'gm2e925' <---> Output : variable 'gm2e925'
                         : Input : variable 'ediff' <---> Output : variable 'ediff'
                         : Input : variable 'gm1eerror' <---> Output : variable 'gm1eerror'
                         : Input : variable 'gm2eerror' <---> Output : variable 'gm2eerror'
                         : Input : variable 'gm1p3cms' <---> Output : variable 'gm1p3cms'
                         : Input : variable 'gm2p3cms' <---> Output : variable 'gm2p3cms'
                         : Input : variable 'gmthetacms' <---> Output : variable 'gmthetacms'
                         : Input : variable 'mfchi2' <---> Output : variable 'mfchi2'
                         : Load model from file: model.h5
Factory                  : Booking method: [1mGTB[0m
                         : 
Factory                  : Booking method: [1mBDT[0m
                         : 
DataSetFactory           : [dataset] : Number of events in input trees
                         : 
                         : 
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 2000
                         : Signal     -- testing events             : 2000
                         : Signal     -- training and testing events: 4000
                         : Background -- training events            : 10000
                         : Background -- testing events             : 10000
                         : Background -- training and testing events: 20000
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : -----------------------------------------------------------------------------------------------------------------------------
                         :               pi0p3 pi0p3cms    gm1e    gm2e gm1e925 gm2e925   ediff gm1eerror gm2eerror gm1p3cms gm2p3cms gmthetacms  mfchi2
                         :      pi0p3:  +1.000   +0.977  +0.959  +0.762  -0.174  -0.174  +0.745    +0.786    +0.676   +0.941   +0.761     -0.691  -0.199
                         :   pi0p3cms:  +0.977   +1.000  +0.937  +0.746  -0.157  -0.157  +0.727    +0.782    +0.678   +0.963   +0.781     -0.686  -0.178
                         :       gm1e:  +0.959   +0.937  +1.000  +0.551  -0.139  -0.139  +0.902    +0.847    +0.492   +0.978   +0.557     -0.624  -0.182
                         :       gm2e:  +0.762   +0.746  +0.551  +1.000  -0.203  -0.203  +0.137    +0.399    +0.885   +0.548   +0.980     -0.570  -0.192
                         :    gm1e925:  -0.174   -0.157  -0.139  -0.203  +1.000  +1.000  -0.060    -0.093    -0.212   -0.126   -0.183     +0.069  -0.036
                         :    gm2e925:  -0.174   -0.157  -0.139  -0.203  +1.000  +1.000  -0.060    -0.093    -0.212   -0.126   -0.183     +0.069  -0.036
                         :      ediff:  +0.745   +0.727  +0.902  +0.137  -0.060  -0.060  +1.000    +0.799    +0.127   +0.877   +0.156     -0.446  -0.117
                         :  gm1eerror:  +0.786   +0.782  +0.847  +0.399  -0.093  -0.093  +0.799    +1.000    +0.385   +0.842   +0.414     -0.394  -0.126
                         :  gm2eerror:  +0.676   +0.678  +0.492  +0.885  -0.212  -0.212  +0.127    +0.385    +1.000   +0.504   +0.884     -0.408  -0.143
                         :   gm1p3cms:  +0.941   +0.963  +0.978  +0.548  -0.126  -0.126  +0.877    +0.842    +0.504   +1.000   +0.585     -0.625  -0.165
                         :   gm2p3cms:  +0.761   +0.781  +0.557  +0.980  -0.183  -0.183  +0.156    +0.414    +0.884   +0.585   +1.000     -0.580  -0.176
                         : gmthetacms:  -0.691   -0.686  -0.624  -0.570  +0.069  +0.069  -0.446    -0.394    -0.408   -0.625   -0.580     +1.000  +0.176
                         :     mfchi2:  -0.199   -0.178  -0.182  -0.192  -0.036  -0.036  -0.117    -0.126    -0.143   -0.165   -0.176     +0.176  +1.000
                         : -----------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : -----------------------------------------------------------------------------------------------------------------------------
                         :               pi0p3 pi0p3cms    gm1e    gm2e gm1e925 gm2e925   ediff gm1eerror gm2eerror gm1p3cms gm2p3cms gmthetacms  mfchi2
                         :      pi0p3:  +1.000   +0.977  +0.969  +0.633  -0.070  -0.070  +0.856    +0.786    +0.497   +0.950   +0.632     -0.687  -0.133
                         :   pi0p3cms:  +0.977   +1.000  +0.949  +0.615  -0.068  -0.068  +0.840    +0.792    +0.500   +0.971   +0.656     -0.696  -0.121
                         :       gm1e:  +0.969   +0.949  +1.000  +0.436  -0.068  -0.068  +0.955    +0.846    +0.345   +0.980   +0.446     -0.597  -0.130
                         :       gm2e:  +0.633   +0.615  +0.436  +1.000  -0.046  -0.046  +0.150    +0.283    +0.813   +0.430   +0.963     -0.513  -0.119
                         :    gm1e925:  -0.070   -0.068  -0.068  -0.046  +1.000  +1.000  -0.059    -0.048    -0.046   -0.065   -0.049     +0.044  +0.015
                         :    gm2e925:  -0.070   -0.068  -0.068  -0.046  +1.000  +1.000  -0.059    -0.048    -0.046   -0.065   -0.049     +0.044  +0.015
                         :      ediff:  +0.856   +0.840  +0.955  +0.150  -0.059  -0.059  +1.000    +0.837    +0.111   +0.935   +0.173     -0.487  -0.103
                         :  gm1eerror:  +0.786   +0.792  +0.846  +0.283  -0.048  -0.048  +0.837    +1.000    +0.248   +0.849   +0.298     -0.345  -0.091
                         :  gm2eerror:  +0.497   +0.500  +0.345  +0.813  -0.046  -0.046  +0.111    +0.248    +1.000   +0.351   +0.805     -0.294  -0.096
                         :   gm1p3cms:  +0.950   +0.971  +0.980  +0.430  -0.065  -0.065  +0.935    +0.849    +0.351   +1.000   +0.466     -0.609  -0.120
                         :   gm2p3cms:  +0.632   +0.656  +0.446  +0.963  -0.049  -0.049  +0.173    +0.298    +0.805   +0.466   +1.000     -0.558  -0.106
                         : gmthetacms:  -0.687   -0.696  -0.597  -0.513  +0.044  +0.044  -0.487    -0.345    -0.294   -0.609   -0.558     +1.000  +0.071
                         :     mfchi2:  -0.133   -0.121  -0.130  -0.119  +0.015  +0.015  -0.103    -0.091    -0.096   -0.120   -0.106     +0.071  +1.000
                         : -----------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [dataset] :  
                         : 
Factory                  : [1mTrain all methods[0m
Factory                  : [dataset] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'pi0p3' <---> Output : variable 'pi0p3'
                         : Input : variable 'pi0p3cms' <---> Output : variable 'pi0p3cms'
                         : Input : variable 'gm1e' <---> Output : variable 'gm1e'
                         : Input : variable 'gm2e' <---> Output : variable 'gm2e'
                         : Input : variable 'gm1e925' <---> Output : variable 'gm1e925'
                         : Input : variable 'gm2e925' <---> Output : variable 'gm2e925'
                         : Input : variable 'ediff' <---> Output : variable 'ediff'
                         : Input : variable 'gm1eerror' <---> Output : variable 'gm1eerror'
                         : Input : variable 'gm2eerror' <---> Output : variable 'gm2eerror'
                         : Input : variable 'gm1p3cms' <---> Output : variable 'gm1p3cms'
                         : Input : variable 'gm2p3cms' <---> Output : variable 'gm2p3cms'
                         : Input : variable 'gmthetacms' <---> Output : variable 'gmthetacms'
                         : Input : variable 'mfchi2' <---> Output : variable 'mfchi2'
Factory                  : [dataset] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'pi0p3' <---> Output : variable 'pi0p3'
                         : Input : variable 'pi0p3cms' <---> Output : variable 'pi0p3cms'
                         : Input : variable 'gm1e' <---> Output : variable 'gm1e'
                         : Input : variable 'gm2e' <---> Output : variable 'gm2e'
                         : Input : variable 'gm1e925' <---> Output : variable 'gm1e925'
                         : Input : variable 'gm2e925' <---> Output : variable 'gm2e925'
                         : Input : variable 'ediff' <---> Output : variable 'ediff'
                         : Input : variable 'gm1eerror' <---> Output : variable 'gm1eerror'
                         : Input : variable 'gm2eerror' <---> Output : variable 'gm2eerror'
                         : Input : variable 'gm1p3cms' <---> Output : variable 'gm1p3cms'
                         : Input : variable 'gm2p3cms' <---> Output : variable 'gm2p3cms'
                         : Input : variable 'gmthetacms' <---> Output : variable 'gmthetacms'
                         : Input : variable 'mfchi2' <---> Output : variable 'mfchi2'
                         : Preparing the Gaussian transformation...
TFHandler_Factory        :   Variable          Mean          RMS   [        Min          Max ]
                         : ---------------------------------------------------------------------
                         :      pi0p3:   0.0056193      1.0010   [     -3.2315      5.7307 ]
                         :   pi0p3cms:   0.0056220      1.0012   [     -3.2343      5.7307 ]
                         :       gm1e:   0.0048241     0.99728   [     -3.2288      5.7307 ]
                         :       gm2e:   0.0053760     0.99894   [     -2.9273      5.7307 ]
                         :    gm1e925:     0.94761      2.3098   [     -3.1853      5.7307 ]
                         :    gm2e925:     0.94761      2.3098   [     -3.1853      5.7307 ]
                         :      ediff:   0.0048178     0.99735   [     -3.1702      5.7307 ]
                         :  gm1eerror:   0.0063653     0.99499   [     -2.9418      5.7307 ]
                         :  gm2eerror:   0.0057270     0.99584   [     -2.9725      5.7307 ]
                         :   gm1p3cms:   0.0048527     0.99758   [     -3.2206      5.7307 ]
                         :   gm2p3cms:   0.0052376     0.99922   [     -3.2125      5.7307 ]
                         : gmthetacms:   0.0057114      1.0013   [     -3.2357      5.7307 ]
                         :     mfchi2:   0.0075830     0.99699   [     -2.4153      5.7307 ]
                         : ---------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
Id_GaussTransformation   : Ranking result (top variable is best ranked)
                         : -----------------------------------
                         : Rank : Variable   : Separation
                         : -----------------------------------
                         :    1 : pi0p3      : 1.964e-01
                         :    2 : mfchi2     : 1.954e-01
                         :    3 : gmthetacms : 1.817e-01
                         :    4 : gm2e       : 1.771e-01
                         :    5 : gm1e       : 1.696e-01
                         :    6 : pi0p3cms   : 1.661e-01
                         :    7 : gm2eerror  : 1.598e-01
                         :    8 : gm1eerror  : 1.560e-01
                         :    9 : gm2p3cms   : 1.477e-01
                         :   10 : gm1p3cms   : 1.445e-01
                         :   11 : ediff      : 8.056e-02
                         :   12 : gm1e925    : 6.057e-02
                         :   13 : gm2e925    : 6.057e-02
                         : -----------------------------------
Factory                  : Train method: PyKeras for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ PyKeras ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_PyKeras        :   Variable          Mean          RMS   [        Min          Max ]
                         : ---------------------------------------------------------------------
                         :      pi0p3:   0.0056193      1.0010   [     -3.2315      5.7307 ]
                         :   pi0p3cms:   0.0056220      1.0012   [     -3.2343      5.7307 ]
                         :       gm1e:   0.0048241     0.99728   [     -3.2288      5.7307 ]
                         :       gm2e:   0.0053760     0.99894   [     -2.9273      5.7307 ]
                         :    gm1e925:     0.94761      2.3098   [     -3.1853      5.7307 ]
                         :    gm2e925:     0.94761      2.3098   [     -3.1853      5.7307 ]
                         :      ediff:   0.0048178     0.99735   [     -3.1702      5.7307 ]
                         :  gm1eerror:   0.0063653     0.99499   [     -2.9418      5.7307 ]
                         :  gm2eerror:   0.0057270     0.99584   [     -2.9725      5.7307 ]
                         :   gm1p3cms:   0.0048527     0.99758   [     -3.2206      5.7307 ]
                         :   gm2p3cms:   0.0052376     0.99922   [     -3.2125      5.7307 ]
                         : gmthetacms:   0.0057114      1.0013   [     -3.2357      5.7307 ]
                         :     mfchi2:   0.0075830     0.99699   [     -2.4153      5.7307 ]
                         : ---------------------------------------------------------------------
                         : Option SaveBestOnly: Only model weights with smallest validation loss will be stored
Train on 12000 samples, validate on 12000 samples
Epoch 1/10

   32/12000 [..............................] - ETA: 57s - loss: 1.0602 - categorical_accuracy: 0.4688
 1600/12000 [===>..........................] - ETA: 1s - loss: 0.6561 - categorical_accuracy: 0.6931 
 3200/12000 [=======>......................] - ETA: 0s - loss: 0.5863 - categorical_accuracy: 0.7444
 4800/12000 [===========>..................] - ETA: 0s - loss: 0.5407 - categorical_accuracy: 0.7731
 6400/12000 [===============>..............] - ETA: 0s - loss: 0.5179 - categorical_accuracy: 0.7864
 8000/12000 [===================>..........] - ETA: 0s - loss: 0.5046 - categorical_accuracy: 0.7926
 9568/12000 [======================>.......] - ETA: 0s - loss: 0.4945 - categorical_accuracy: 0.7973
11168/12000 [==========================>...] - ETA: 0s - loss: 0.4795 - categorical_accuracy: 0.8035
12000/12000 [==============================] - 1s 66us/step - loss: 0.4767 - categorical_accuracy: 0.8045 - val_loss: 0.3757 - val_categorical_accuracy: 0.8378

Epoch 00001: val_loss improved from inf to 0.37574, saving model to dataset/weights/TrainedModel_PyKeras.h5
Epoch 2/10

   32/12000 [..............................] - ETA: 0s - loss: 0.4484 - categorical_accuracy: 0.8750
 1568/12000 [==>...........................] - ETA: 0s - loss: 0.3991 - categorical_accuracy: 0.8418
 3200/12000 [=======>......................] - ETA: 0s - loss: 0.3922 - categorical_accuracy: 0.8453
 4544/12000 [==========>...................] - ETA: 0s - loss: 0.3965 - categorical_accuracy: 0.8407
 6208/12000 [==============>...............] - ETA: 0s - loss: 0.3981 - categorical_accuracy: 0.8383
 7776/12000 [==================>...........] - ETA: 0s - loss: 0.3965 - categorical_accuracy: 0.8413
 9408/12000 [======================>.......] - ETA: 0s - loss: 0.3961 - categorical_accuracy: 0.8416
10848/12000 [==========================>...] - ETA: 0s - loss: 0.3995 - categorical_accuracy: 0.8401
12000/12000 [==============================] - 1s 52us/step - loss: 0.3986 - categorical_accuracy: 0.8406 - val_loss: 0.3608 - val_categorical_accuracy: 0.8528

Epoch 00002: val_loss improved from 0.37574 to 0.36077, saving model to dataset/weights/TrainedModel_PyKeras.h5
Epoch 3/10

   32/12000 [..............................] - ETA: 0s - loss: 0.3995 - categorical_accuracy: 0.8438
 1600/12000 [===>..........................] - ETA: 0s - loss: 0.3954 - categorical_accuracy: 0.8425
 3168/12000 [======>.......................] - ETA: 0s - loss: 0.3987 - categorical_accuracy: 0.8447
 4736/12000 [==========>...................] - ETA: 0s - loss: 0.3914 - categorical_accuracy: 0.8459
 6272/12000 [==============>...............] - ETA: 0s - loss: 0.3911 - categorical_accuracy: 0.8444
 7904/12000 [==================>...........] - ETA: 0s - loss: 0.3877 - categorical_accuracy: 0.8448
 9472/12000 [======================>.......] - ETA: 0s - loss: 0.3881 - categorical_accuracy: 0.8439
11136/12000 [==========================>...] - ETA: 0s - loss: 0.3871 - categorical_accuracy: 0.8429
12000/12000 [==============================] - 1s 51us/step - loss: 0.3861 - categorical_accuracy: 0.8424 - val_loss: 0.3536 - val_categorical_accuracy: 0.8591

Epoch 00003: val_loss improved from 0.36077 to 0.35356, saving model to dataset/weights/TrainedModel_PyKeras.h5
Epoch 4/10

   32/12000 [..............................] - ETA: 1s - loss: 0.4877 - categorical_accuracy: 0.7188
 1632/12000 [===>..........................] - ETA: 0s - loss: 0.3993 - categorical_accuracy: 0.8346
 3200/12000 [=======>......................] - ETA: 0s - loss: 0.3773 - categorical_accuracy: 0.8419
 4832/12000 [===========>..................] - ETA: 0s - loss: 0.3805 - categorical_accuracy: 0.8398
 6432/12000 [===============>..............] - ETA: 0s - loss: 0.3847 - categorical_accuracy: 0.8396
 8128/12000 [===================>..........] - ETA: 0s - loss: 0.3770 - categorical_accuracy: 0.8444
 9696/12000 [=======================>......] - ETA: 0s - loss: 0.3739 - categorical_accuracy: 0.8465
11360/12000 [===========================>..] - ETA: 0s - loss: 0.3749 - categorical_accuracy: 0.8480
12000/12000 [==============================] - 1s 51us/step - loss: 0.3728 - categorical_accuracy: 0.8483 - val_loss: 0.3501 - val_categorical_accuracy: 0.8605

Epoch 00004: val_loss improved from 0.35356 to 0.35006, saving model to dataset/weights/TrainedModel_PyKeras.h5
Epoch 5/10

   32/12000 [..............................] - ETA: 0s - loss: 0.2960 - categorical_accuracy: 0.8750
 1568/12000 [==>...........................] - ETA: 0s - loss: 0.3808 - categorical_accuracy: 0.8431
 3168/12000 [======>.......................] - ETA: 0s - loss: 0.3692 - categorical_accuracy: 0.8507
 4800/12000 [===========>..................] - ETA: 0s - loss: 0.3753 - categorical_accuracy: 0.8490
 6368/12000 [==============>...............] - ETA: 0s - loss: 0.3675 - categorical_accuracy: 0.8524
 7968/12000 [==================>...........] - ETA: 0s - loss: 0.3678 - categorical_accuracy: 0.8509
 9568/12000 [======================>.......] - ETA: 0s - loss: 0.3660 - categorical_accuracy: 0.8513
11200/12000 [===========================>..] - ETA: 0s - loss: 0.3666 - categorical_accuracy: 0.8512
12000/12000 [==============================] - 1s 51us/step - loss: 0.3663 - categorical_accuracy: 0.8519 - val_loss: 0.3489 - val_categorical_accuracy: 0.8608

Epoch 00005: val_loss improved from 0.35006 to 0.34889, saving model to dataset/weights/TrainedModel_PyKeras.h5
Epoch 6/10

   32/12000 [..............................] - ETA: 0s - loss: 0.2341 - categorical_accuracy: 0.9062
 1600/12000 [===>..........................] - ETA: 0s - loss: 0.3388 - categorical_accuracy: 0.8625
 3200/12000 [=======>......................] - ETA: 0s - loss: 0.3477 - categorical_accuracy: 0.8603
 4864/12000 [===========>..................] - ETA: 0s - loss: 0.3426 - categorical_accuracy: 0.8639
 6400/12000 [===============>..............] - ETA: 0s - loss: 0.3505 - categorical_accuracy: 0.8597
 8032/12000 [===================>..........] - ETA: 0s - loss: 0.3555 - categorical_accuracy: 0.8563
 9568/12000 [======================>.......] - ETA: 0s - loss: 0.3585 - categorical_accuracy: 0.8548
11264/12000 [===========================>..] - ETA: 0s - loss: 0.3624 - categorical_accuracy: 0.8526
12000/12000 [==============================] - 1s 51us/step - loss: 0.3633 - categorical_accuracy: 0.8520 - val_loss: 0.3513 - val_categorical_accuracy: 0.8580

Epoch 00006: val_loss did not improve from 0.34889
Epoch 7/10

   32/12000 [..............................] - ETA: 0s - loss: 0.2688 - categorical_accuracy: 0.9062
 1632/12000 [===>..........................] - ETA: 0s - loss: 0.3505 - categorical_accuracy: 0.8591
 3264/12000 [=======>......................] - ETA: 0s - loss: 0.3491 - categorical_accuracy: 0.8609
 4640/12000 [==========>...................] - ETA: 0s - loss: 0.3510 - categorical_accuracy: 0.8580
 6272/12000 [==============>...............] - ETA: 0s - loss: 0.3587 - categorical_accuracy: 0.8571
 7808/12000 [==================>...........] - ETA: 0s - loss: 0.3598 - categorical_accuracy: 0.8559
 9408/12000 [======================>.......] - ETA: 0s - loss: 0.3630 - categorical_accuracy: 0.8525
10976/12000 [==========================>...] - ETA: 0s - loss: 0.3625 - categorical_accuracy: 0.8530
12000/12000 [==============================] - 1s 51us/step - loss: 0.3628 - categorical_accuracy: 0.8529 - val_loss: 0.3482 - val_categorical_accuracy: 0.8611

Epoch 00007: val_loss improved from 0.34889 to 0.34819, saving model to dataset/weights/TrainedModel_PyKeras.h5
Epoch 8/10

   32/12000 [..............................] - ETA: 0s - loss: 0.4760 - categorical_accuracy: 0.7500
 1504/12000 [==>...........................] - ETA: 0s - loss: 0.3440 - categorical_accuracy: 0.8584
 3040/12000 [======>.......................] - ETA: 0s - loss: 0.3442 - categorical_accuracy: 0.8595
 4672/12000 [==========>...................] - ETA: 0s - loss: 0.3466 - categorical_accuracy: 0.8594
 6208/12000 [==============>...............] - ETA: 0s - loss: 0.3590 - categorical_accuracy: 0.8524
 7840/12000 [==================>...........] - ETA: 0s - loss: 0.3618 - categorical_accuracy: 0.8528
 9408/12000 [======================>.......] - ETA: 0s - loss: 0.3588 - categorical_accuracy: 0.8530
11072/12000 [==========================>...] - ETA: 0s - loss: 0.3604 - categorical_accuracy: 0.8527
12000/12000 [==============================] - 1s 51us/step - loss: 0.3606 - categorical_accuracy: 0.8515 - val_loss: 0.3463 - val_categorical_accuracy: 0.8606

Epoch 00008: val_loss improved from 0.34819 to 0.34631, saving model to dataset/weights/TrainedModel_PyKeras.h5
Epoch 9/10

   32/12000 [..............................] - ETA: 0s - loss: 0.3572 - categorical_accuracy: 0.8125
 1632/12000 [===>..........................] - ETA: 0s - loss: 0.3519 - categorical_accuracy: 0.8646
 3232/12000 [=======>......................] - ETA: 0s - loss: 0.3650 - categorical_accuracy: 0.8552
 4736/12000 [==========>...................] - ETA: 0s - loss: 0.3570 - categorical_accuracy: 0.8579
 6304/12000 [==============>...............] - ETA: 0s - loss: 0.3572 - categorical_accuracy: 0.8549
 7968/12000 [==================>...........] - ETA: 0s - loss: 0.3613 - categorical_accuracy: 0.8525
 9472/12000 [======================>.......] - ETA: 0s - loss: 0.3596 - categorical_accuracy: 0.8538
11104/12000 [==========================>...] - ETA: 0s - loss: 0.3595 - categorical_accuracy: 0.8536
12000/12000 [==============================] - 1s 51us/step - loss: 0.3585 - categorical_accuracy: 0.8547 - val_loss: 0.3441 - val_categorical_accuracy: 0.8607

Epoch 00009: val_loss improved from 0.34631 to 0.34413, saving model to dataset/weights/TrainedModel_PyKeras.h5
Epoch 10/10

   32/12000 [..............................] - ETA: 0s - loss: 0.2597 - categorical_accuracy: 0.8750
 1696/12000 [===>..........................] - ETA: 0s - loss: 0.3479 - categorical_accuracy: 0.8526
 3168/12000 [======>.......................] - ETA: 0s - loss: 0.3571 - categorical_accuracy: 0.8510
 4832/12000 [===========>..................] - ETA: 0s - loss: 0.3567 - categorical_accuracy: 0.8539
 6400/12000 [===============>..............] - ETA: 0s - loss: 0.3579 - categorical_accuracy: 0.8530
 8000/12000 [===================>..........] - ETA: 0s - loss: 0.3569 - categorical_accuracy: 0.8525
 9568/12000 [======================>.......] - ETA: 0s - loss: 0.3555 - categorical_accuracy: 0.8537
11232/12000 [===========================>..] - ETA: 0s - loss: 0.3561 - categorical_accuracy: 0.8540
12000/12000 [==============================] - 1s 51us/step - loss: 0.3571 - categorical_accuracy: 0.8537 - val_loss: 0.3461 - val_categorical_accuracy: 0.8621

Epoch 00010: val_loss did not improve from 0.34413
                         : Elapsed time for training with 12000 events: [1;31m7.12 sec[0m         
                         : Creating xml weight file: [0;36mdataset/weights/TMVAClassification_PyKeras.weights.xml[0m
                         : Creating standalone class: [0;36mdataset/weights/TMVAClassification_PyKeras.class.C[0m
Factory                  : Training finished
                         : 
Factory                  : Train method: GTB for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ GTB ] :[0m
                         : A gradient tree boosting classifier builds a model from an ensemble
                         : of decision trees, which are adapted each boosting step to fit better
                         : to previously misclassified events.
                         : 
                         : Check out the scikit-learn documentation for more information.
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : 
                         : [1mSaving state file: [0mdataset/weights/PyGTBModel_GTB.PyData
                         : 
                         : Elapsed time for training with 12000 events: [1;31m3.28 sec[0m         
                         : Creating xml weight file: [0;36mdataset/weights/TMVAClassification_GTB.weights.xml[0m
                         : Creating standalone class: [0;36mdataset/weights/TMVAClassification_GTB.class.C[0m
Factory                  : Training finished
                         : 
Factory                  : Train method: BDT for Classification
                         : 
BDT                      : #events: (reweighted) sig: 6000 bkg: 6000
                         : #events: (unweighted) sig: 2000 bkg: 10000
                         : Training 10 Decision Trees ... patience please
                         : Elapsed time for training with 12000 events: [1;31m0.241 sec[0m         
BDT                      : [dataset] : Evaluation of BDT on training sample (12000 events)
                         : Elapsed time for evaluation of 12000 events: [1;31m0.012 sec[0m       
                         : Creating xml weight file: [0;36mdataset/weights/TMVAClassification_BDT.weights.xml[0m
                         : Creating standalone class: [0;36mdataset/weights/TMVAClassification_BDT.class.C[0m
                         : MVAOutput.root:/dataset/Method_BDT/BDT
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: PyKeras
GTB                      : Ranking result (top variable is best ranked)
                         : --------------------------------------------
                         : Rank : Variable   : Variable Importance
                         : --------------------------------------------
                         :    1 : mfchi2     : 2.839e-01
                         :    2 : pi0p3      : 2.712e-01
                         :    3 : gm2e       : 1.112e-01
                         :    4 : gmthetacms : 4.840e-02
                         :    5 : gm2p3cms   : 3.992e-02
                         :    6 : gm1e925    : 3.921e-02
                         :    7 : gm2e925    : 3.699e-02
                         :    8 : gm1p3cms   : 3.575e-02
                         :    9 : pi0p3cms   : 3.237e-02
                         :   10 : ediff      : 2.916e-02
                         :   11 : gm1eerror  : 2.751e-02
                         :   12 : gm1e       : 2.494e-02
                         :   13 : gm2eerror  : 1.946e-02
                         : --------------------------------------------
BDT                      : Ranking result (top variable is best ranked)
                         : --------------------------------------------
                         : Rank : Variable   : Variable Importance
                         : --------------------------------------------
                         :    1 : mfchi2     : 2.903e-01
                         :    2 : pi0p3      : 2.288e-01
                         :    3 : gm2e       : 2.178e-01
                         :    4 : gmthetacms : 7.782e-02
                         :    5 : gm1e925    : 6.933e-02
                         :    6 : gm2p3cms   : 4.235e-02
                         :    7 : gm1p3cms   : 2.759e-02
                         :    8 : pi0p3cms   : 2.455e-02
                         :    9 : gm1e       : 2.148e-02
                         :   10 : gm2e925    : 0.000e+00
                         :   11 : ediff      : 0.000e+00
                         :   12 : gm1eerror  : 0.000e+00
                         :   13 : gm2eerror  : 0.000e+00
                         : --------------------------------------------
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: PyKeras for Classification performance
                         : 
                         : Load model from file: dataset/weights/TrainedModel_PyKeras.h5
Factory                  : Test method: GTB for Classification performance
                         : 
                         : 
                         : [1mLoading state file: [0mdataset/weights/PyGTBModel_GTB.PyData
                         : 
Factory                  : Test method: BDT for Classification performance
                         : 
BDT                      : [dataset] : Evaluation of BDT on testing sample (12000 events)
                         : Elapsed time for evaluation of 12000 events: [1;31m0.00973 sec[0m       
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: PyKeras
                         : 
TFHandler_PyKeras        :   Variable          Mean          RMS   [        Min          Max ]
                         : ---------------------------------------------------------------------
                         :      pi0p3:    0.022289      1.0030   [     -5.7307      5.7307 ]
                         :   pi0p3cms:    0.022985     0.99795   [     -3.4748      5.7307 ]
                         :       gm1e:    0.021385     0.99626   [     -3.2270      5.7307 ]
                         :       gm2e:    0.031328     0.98994   [     -2.9256      5.7307 ]
                         :    gm1e925:     0.94502      2.3155   [     -3.0733      5.7307 ]
                         :    gm2e925:     0.94502      2.3155   [     -3.0733      5.7307 ]
                         :      ediff:   0.0074928      1.0080   [     -3.1425      5.7307 ]
                         :  gm1eerror:    0.023489     0.99357   [     -2.9316      5.7307 ]
                         :  gm2eerror:    0.030198     0.99151   [     -2.9391      5.7307 ]
                         :   gm1p3cms:    0.020516     0.99795   [     -5.7307      5.7307 ]
                         :   gm2p3cms:    0.025183     0.99930   [     -3.2901      5.7307 ]
                         : gmthetacms:   -0.012346     0.99551   [     -3.1925      5.7307 ]
                         :     mfchi2:  -0.0072295     0.99905   [     -2.4152      5.7307 ]
                         : ---------------------------------------------------------------------
PyKeras                  : [dataset] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_PyKeras        :   Variable          Mean          RMS   [        Min          Max ]
                         : ---------------------------------------------------------------------
                         :      pi0p3:    0.022289      1.0030   [     -5.7307      5.7307 ]
                         :   pi0p3cms:    0.022985     0.99795   [     -3.4748      5.7307 ]
                         :       gm1e:    0.021385     0.99626   [     -3.2270      5.7307 ]
                         :       gm2e:    0.031328     0.98994   [     -2.9256      5.7307 ]
                         :    gm1e925:     0.94502      2.3155   [     -3.0733      5.7307 ]
                         :    gm2e925:     0.94502      2.3155   [     -3.0733      5.7307 ]
                         :      ediff:   0.0074928      1.0080   [     -3.1425      5.7307 ]
                         :  gm1eerror:    0.023489     0.99357   [     -2.9316      5.7307 ]
                         :  gm2eerror:    0.030198     0.99151   [     -2.9391      5.7307 ]
                         :   gm1p3cms:    0.020516     0.99795   [     -5.7307      5.7307 ]
                         :   gm2p3cms:    0.025183     0.99930   [     -3.2901      5.7307 ]
                         : gmthetacms:   -0.012346     0.99551   [     -3.1925      5.7307 ]
                         :     mfchi2:  -0.0072295     0.99905   [     -2.4152      5.7307 ]
                         : ---------------------------------------------------------------------
Factory                  : Evaluate classifier: GTB
                         : 
GTB                      : [dataset] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_GTB            :   Variable          Mean          RMS   [        Min          Max ]
                         : ---------------------------------------------------------------------
                         :      pi0p3:     0.39463     0.36128   [   0.0010822      4.2252 ]
                         :   pi0p3cms:     0.50881     0.48428   [   0.0084214      5.9243 ]
                         :       gm1e:     0.30262     0.28283   [    0.061266      4.1162 ]
                         :       gm2e:     0.12752    0.097868   [    0.060001      1.5385 ]
                         :    gm1e925:     0.95012    0.062448   [     0.29383      1.0000 ]
                         :    gm2e925:     0.95012    0.062448   [     0.29383      1.0000 ]
                         :      ediff:     0.17510     0.24596   [  1.9461e-05      4.0092 ]
                         :  gm1eerror:  6.8343e-05  0.00019084   [  1.9603e-06   0.0051441 ]
                         :  gm2eerror:  1.2210e-05  3.2090e-05   [  1.6939e-06   0.0012737 ]
                         :   gm1p3cms:     0.38017     0.38332   [    0.045125      5.6465 ]
                         :   gm2p3cms:     0.15806     0.13274   [    0.042989      2.1753 ]
                         : gmthetacms:     0.91320     0.55704   [    0.047489      3.0819 ]
                         :     mfchi2:      12.069      12.527   [  1.0747e-06      49.996 ]
                         : ---------------------------------------------------------------------
Factory                  : Evaluate classifier: BDT
                         : 
BDT                      : [dataset] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_BDT            :   Variable          Mean          RMS   [        Min          Max ]
                         : ---------------------------------------------------------------------
                         :      pi0p3:     0.39463     0.36128   [   0.0010822      4.2252 ]
                         :   pi0p3cms:     0.50881     0.48428   [   0.0084214      5.9243 ]
                         :       gm1e:     0.30262     0.28283   [    0.061266      4.1162 ]
                         :       gm2e:     0.12752    0.097868   [    0.060001      1.5385 ]
                         :    gm1e925:     0.95012    0.062448   [     0.29383      1.0000 ]
                         :    gm2e925:     0.95012    0.062448   [     0.29383      1.0000 ]
                         :      ediff:     0.17510     0.24596   [  1.9461e-05      4.0092 ]
                         :  gm1eerror:  6.8343e-05  0.00019084   [  1.9603e-06   0.0051441 ]
                         :  gm2eerror:  1.2210e-05  3.2090e-05   [  1.6939e-06   0.0012737 ]
                         :   gm1p3cms:     0.38017     0.38332   [    0.045125      5.6465 ]
                         :   gm2p3cms:     0.15806     0.13274   [    0.042989      2.1753 ]
                         : gmthetacms:     0.91320     0.55704   [    0.047489      3.0819 ]
                         :     mfchi2:      12.069      12.527   [  1.0747e-06      49.996 ]
                         : ---------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : dataset       GTB            : 0.822
                         : dataset       PyKeras        : 0.822
                         : dataset       BDT            : 0.812
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : dataset              GTB            : 0.187 (0.340)       0.539 (0.612)      0.768 (0.820)
                         : dataset              PyKeras        : 0.189 (0.191)       0.537 (0.544)      0.776 (0.801)
                         : dataset              BDT            : 0.000 (0.000)       0.525 (0.542)      0.764 (0.781)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:dataset          : Created tree 'TestTree' with 12000 events
                         : 
Dataset:dataset          : Created tree 'TrainTree' with 12000 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
